<html>
  <head>
    <title>Increment Sample</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    <script src='zephyr.js' type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            var counterRef = new ZephyrBase('a', 'x', 'counter');
            counterRef.onchange = function (counter) {
                $('#value').text(counter.value);
            };
            $('#incr').click(function () {
                counterRef.putSafe(function(counter) {
                    if (counter) {
                        // existing
                        counter.value++;
                    }
                    else {
                        // new counter
                        counter = { value: 0 };
                    }
                    return counter;
                });
            });
        });
    </script>
    <input type="button" id="incr" value='Increment'/>
    <br/>
    <span id="value">Unknown</span>
  </body>
</html>
